/*!
 * CustomAlert.js - A simple and powerful JavaScript alert system
 * Author: Rajkumar Nimod
 * Website: https://changealert.netlify.app/
 * Version: 1.0.0
 * License: MIT
 */

!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.ChangeAlert=t()}(this,function(){"use strict";let e={position:"top-right",timeout:5e3,theme:"primary",themeMode:"auto",icon:null,closeButton:!0,pauseOnHover:!0,draggable:!1,progressBar:!0,sound:!1,html:!1,animationIn:"fadeIn",animationOut:"fadeOut",onClick:null,onClose:null,onShow:null,onTimeout:null,rtl:!1,customClass:"",queue:!0,zIndex:999999,overlay:!1,overlayClose:!1,overlayColor:"rgba(0,0,0,0.5)",customIcon:null,customSound:null,buttons:null,focus:!0},t={success:"https://actions.google.com/sounds/v1/cartoon/clang_and_wobble.ogg",error:"https://actions.google.com/sounds/v1/alarms/beep_short.ogg",warning:"https://actions.google.com/sounds/v1/alarms/alarm_clock.ogg",info:"https://actions.google.com/sounds/v1/cartoon/pop.ogg",question:"https://actions.google.com/sounds/v1/cartoon/slide_whistle_to_drum_hit.ogg",loading:"https://actions.google.com/sounds/v1/science_fiction/futuristic_spacecraft_takeoff.ogg",primary:"https://actions.google.com/sounds/v1/cartoon/pop.ogg",secondary:"https://actions.google.com/sounds/v1/cartoon/boing.ogg"},o={success:"✅",error:"❌",warning:"⚠️",info:"ℹ️",question:"❓",loading:"⏳",primary:"\uD83D\uDD35",secondary:"⚪"},s=[],n=!1,r=null,a="auto",i=null,l=new class l{constructor(){this.initContainer(),this.initTheme()}initContainer(){if(!document.querySelector(".changealert-container")){let e=document.createElement("div");e.className="changealert-container top-right",document.body.appendChild(e)}}initTheme(){if(window.matchMedia){let e=window.matchMedia("(prefers-color-scheme: dark)");i&&e.removeListener(i),i=e=>{"auto"===a&&this.updateTheme()},e.addListener(i)}this.updateTheme()}updateTheme(){let e=document.querySelector(".changealert-container");e&&("dark"===a||"auto"===a&&this.isSystemDark()?e.setAttribute("data-changealert-theme","dark"):e.setAttribute("data-changealert-theme","light"))}isSystemDark(){return window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches}setThemeMode(e){return["auto","light","dark"].includes(e)&&(a=e,this.updateTheme()),this}createOverlay(e,t,o){r||((r=document.createElement("div")).style.position="fixed",r.style.top="0",r.style.left="0",r.style.width="100%",r.style.height="100%",r.style.backgroundColor=e,r.style.zIndex=t-1,r.style.opacity="0",r.style.transition="opacity 0.3s",o&&(r.style.cursor="pointer",r.addEventListener("click",()=>this.clear())),document.body.appendChild(r),setTimeout(()=>{r.style.opacity="1"},10))}removeOverlay(){r&&(r.style.opacity="0",setTimeout(()=>{r.remove(),r=null},300))}createAlert(e,t){let s=document.createElement("div");s.className=`changealert ${t.theme} ${t.customClass} ${t.rtl?"rtl":""}`,s.dataset.animationIn=t.animationIn,s.dataset.animationOut=t.animationOut;let n=t.customIcon||t.icon||o[t.theme]||"";"string"==typeof n&&(n.startsWith("http")||n.startsWith("/"))&&(n=`<img src="${n}" alt="alert icon">`);let r=n?`<div class="changealert-icon">${n}</div>`:"",a=t.closeButton?'<button class="changealert-close" aria-label="Close">&times;</button>':"",i="";t.buttons&&Array.isArray(t.buttons)&&(i='<div class="changealert-buttons">',t.buttons.forEach(e=>{i+=`<button class="${e.class||""}" style="${e.style||""}">${e.text}</button>`}),i+="</div>");let l=t.html?e:document.createTextNode(e).textContent;return s.innerHTML=`
        <div class="changealert-content">
          ${r}
          <div class="changealert-message">${l}</div>
        </div>
        ${a}
        ${i}
        ${t.progressBar?'<div class="changealert-progress"></div>':""}
      `,t.draggable&&(s.classList.add("draggable"),this.makeDraggable(s)),s}makeDraggable(e){let t=0,o=0,s=0,n=0,r=!1,a=t=>{0===t.button&&(t.preventDefault(),s=t.clientX,n=t.clientY,r=!0,document.onmouseup=l,document.onmousemove=i,e.style.transition="none")},i=a=>{r&&(a.preventDefault(),t=s-a.clientX,o=n-a.clientY,s=a.clientX,n=a.clientY,e.style.top=e.offsetTop-o+"px",e.style.left=e.offsetLeft-t+"px")},l=()=>{document.onmouseup=null,document.onmousemove=null,r=!1,e.style.transition="transform 0.3s, opacity 0.3s"};e.onmousedown=a}showAlert(e,t,o){let s=document.querySelector(".changealert-container");s.appendChild(e),e.style.zIndex=o,e.offsetWidth,e.classList.add(`changealert-${t}`),setTimeout(()=>{e.classList.remove(`changealert-${t}`)},300)}hideAlert(e,t,o){e.classList.add(`changealert-${t}`),setTimeout(()=>{e.style.opacity="0",setTimeout(()=>{e.remove(),o&&o()},300)},100)}setupProgressBar(e,t,o){if(!t||t<=0)return;let s=e.querySelector(".changealert-progress");if(!s)return;let n=Date.now(),r=!1,a=0,i,l=()=>{if(r)return;let a=Date.now()-n,c=Math.min(a/t,1);s.style.transform=`scaleX(${1-c})`,c>=1?(cancelAnimationFrame(i),o&&o(),this.hideAlert(e,e.dataset.animationOut)):i=requestAnimationFrame(l)};"true"===e.dataset.pauseOnHover&&(e.addEventListener("mouseenter",()=>{r=!0,a=Date.now(),cancelAnimationFrame(i)}),e.addEventListener("mouseleave",()=>{r=!1,n+=Date.now()-a,i=requestAnimationFrame(l)})),i=requestAnimationFrame(l)}processQueue(){if(n||0===s.length)return;n=!0;let{message:e,options:t,resolve:o}=s.shift();this.show(e,t).then(()=>{n=!1,o(),this.processQueue()})}show(t,o={}){return new Promise(n=>{let r={...e,...o};if(this.setContainerPosition(r.position,r.zIndex),r.overlay&&this.createOverlay(r.overlayColor,r.zIndex,r.overlayClose),r.queue&&s.length>0){s.push({message:t,options:r,resolve:n});return}let a=this.createAlert(t,r);if(a.dataset.pauseOnHover=r.pauseOnHover,(r.sound||r.customSound)&&this.playSound(r.theme,r.customSound),this.showAlert(a,r.animationIn,r.zIndex),r.onShow&&r.onShow(a),r.focus&&setTimeout(()=>a.focus(),50),r.buttons&&r.buttons.forEach((e,t)=>{let o=a.querySelectorAll(".changealert-buttons button")[t];o&&e.action&&o.addEventListener("click",t=>{t.stopPropagation(),e.action()})}),r.timeout>0&&this.setupProgressBar(a,r.timeout,()=>{r.onTimeout&&r.onTimeout(),r.overlay&&this.removeOverlay(),n()}),r.closeButton){let i=a.querySelector(".changealert-close");i.addEventListener("click",()=>{this.hideAlert(a,r.animationOut,()=>{r.onClose&&r.onClose(),r.overlay&&this.removeOverlay(),n()})})}r.onClick&&a.addEventListener("click",e=>{e.target===a.querySelector(".changealert-close")||e.target.closest(".changealert-buttons")||r.onClick(e)}),a.setAttribute("role","alert"),a.setAttribute("aria-live","assertive"),a.tabIndex=0,a.addEventListener("keydown",e=>{if("Escape"===e.key&&r.closeButton){let t=a.querySelector(".changealert-close");t&&t.click()}}),r.timeout<=0&&n()})}primary(e,t={}){return this.show(e,{...t,theme:"primary"})}secondary(e,t={}){return this.show(e,{...t,theme:"secondary"})}success(e,t={}){return this.show(e,{...t,theme:"success"})}error(e,t={}){return this.show(e,{...t,theme:"error"})}warning(e,t={}){return this.show(e,{...t,theme:"warning"})}info(e,t={}){return this.show(e,{...t,theme:"info"})}question(e,t={}){return this.show(e,{...t,theme:"question"})}loading(e,t={}){return this.show(e,{...t,theme:"loading",timeout:0})}clear(){let e=document.querySelector(".changealert-container");if(e)for(;e.firstChild;)e.removeChild(e.firstChild);s=[],n=!1,this.removeOverlay()}playSound(e,o){let s=o||t[e];if(!s)return;let n=new Audio(s);n.play().catch(e=>console.warn("Sound playback failed:",e))}setContainerPosition(e,t){let o=document.querySelector(".changealert-container");o&&(o.className=`changealert-container ${e}`,o.style.zIndex=t)}applyTheme(e){return"string"==typeof e?document.documentElement.style.setProperty("--changealert-primary",e):"object"==typeof e&&Object.keys(e).forEach(t=>{document.documentElement.style.setProperty(`--changealert-${t}`,e[t])}),this}setIcons(e){return Object.keys(e).forEach(t=>{o[t]=e[t]}),this}setSounds(e){return Object.keys(e).forEach(o=>{t[o]=e[o]}),this}};return["show","primary","secondary","success","error","warning","info","question","loading","clear","applyTheme","setIcons","setSounds","setThemeMode"].forEach(e=>{l[e]=l[e].bind(l)}),l});